var microsite=function(){function e(){r()&&t(n())}function n(){var e=$("#first-name").val(),n=$("#last-name").val(),t=$("#street_number").val(),o=$("#route").val();return{merchantUuid:"748f710d-3801-41d2-9235-3c42bf7c6b80",campaigns:["c-735f0a46-4f8e-4e84-ae21-57177676db22"],email:m.val(),fullName:e+" "+n,forename:e,surname:n,address1:t+" "+o,city:$("#postal_town").val(),zip:f.val(),country:"GB",phone:$("#phone").val(),gender:$("#gender").val(),source:document.referrer}}function t(e){$.ajax({url:d+"//prod.expresslyapp.com/api/adserver/banner/precache",type:"POST",data:JSON.stringify(e),contentType:"application/json",xhrFields:{withCredentials:!0},success:function(e){window.location.href=e.migrationLink},error:function(e){console.log(e),alert("Oops, something went wrong with your submission. Please try again.")}})}function o(e){var n=$("#global-error");n.html(e),n.toggleClass("error-hidden",!e)}function r(){o(),$(".field-error").removeClass("field-error");for(var e=0;e<p.length;++e){var n=p[e]();if(n)return o(n),!1}return!0}function a(e,n){var t=n.test(e.val());return e.toggleClass("field-error",!t),t}function i(e){var n=e.prop("checked");return e.toggleClass("field-error",!n),n}function s(){$(".hidden-field").removeClass("hidden-field")}function c(){var e=u.getPlace();for(var n in g)document.getElementById(n).value="",document.getElementById(n).disabled=!1;for(var t=0;t<e.address_components.length;t++){var o=e.address_components[t].types[0];g[o]&&(document.getElementById(o).value=e.address_components[t][g[o]])}}function l(){navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(e){var n={lat:e.coords.latitude,lng:e.coords.longitude},t=new google.maps.Circle({center:n,radius:e.coords.accuracy});u.setBounds(t.getBounds())})}$.support.cors=!0;var u,d="https:",m=$("#email"),f=$("#postal_code"),p=[function(){var e=!0;return $(".required").each(function(){""===$(this).val()&&($(this).addClass("field-error"),e=!1)}),e?"":"Please ensure all fields are filled"},function(){return a(m,/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/)?"":"Please enter a valid email address"},function(){return a(f,/^((?:(?:gir)|(?:[a-pr-uwyz])(?:(?:[0-9](?:[a-hjkpstuw]|[0-9])?)|(?:[a-hk-y][0-9](?:[0-9]|[abehmnprv-y])?)))) ?([0-9][abd-hjlnp-uw-z]{2})$/i)?"":"Please enter a valid postcode"},function(){return i($("#age-confirmation"))?"":"Please confirm your age"},function(){return i($("#term-confirmation"))?"":"Please accept the terms and conditions"}],g={street_number:"short_name",route:"long_name",postal_town:"long_name",postal_code:"short_name"};return $("#show-fields").click(s),$("#nife-contact-form").submit(function(n){n.preventDefault(),e()}),$("#autocomplete").focus(l),{initAutocomplete:function(){(u=new google.maps.places.Autocomplete(document.getElementById("autocomplete"),{types:["address"],componentRestrictions:{country:"uk"}})).addListener("place_changed",function(){c(),s()})},matchProtocol:function(e){d=!0===e?window.location.protocol:"https:",console.log("p="+e+","+d)}}}();$(function(){navigator.userAgent.match(/(iPad|iPhone|iPod)/g)&&setTimeout(function(){document.getElementsByClassName("pac-container")[0].addEventListener("touchend",function(e){e.stopImmediatePropagation()})},500),document.documentElement.setAttribute("data-useragent",navigator.userAgent)});